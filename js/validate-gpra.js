class GPRA
{
    GrantNo;
    ClientID;
    ClientType;
    InterviewTypeCode;
    IntakeSeqNum;
    InterviewDate;
    ICD10CodeOne;
    ICD10CodeOneCategory;
    ICD10CodeTwo;
    ICD10CodeTwoCategory;
    ICD10CodeThree;
    ICD10CodeThreeCategory;
    OpioidDisorder;
    MethadoneMedication;
    MethadoneMedicationDays;
    BuprenorphineMedication;
    BuprenorphineMedicationDays;
    NaltrexoneMedication;
    NaltrexoneMedicationDays;
    NaltrexoneXRMedication;
    NaltrexoneXRMedicationDays;
    AlcoholDisorder;
    NaltrexoneAlcMedication;
    NaltrexoneAlcMedicationDays;
    NaltrexoneXRAlcMedication;
    NaltrexoneXRAlcMedicationDays;
    DisulfiramMedication;
    DisulfiramMedicationDays;
    AcamprosateMedication;
    AcamprosateMedicationDays;
    ClientIntake_CooccurringScreen;
    ClientIntake_CooccurringScreenStatus;
    ClientIntake_ClientIntakeSBIRT_ClientScreen;
    ClientIntake_ClientIntakeSBIRT_ScoreType1;
    ClientIntake_ClientIntakeSBIRT_ScoreValue1;
    SbirtOtherspec1;
    ClientIntake_ClientIntakeSBIRT_ScoreType2;
    ClientIntake_ClientIntakeSBIRT_ScoreValue2;
    SbirtOtherspec2;
    ClientIntake_ClientIntakeSBIRT_ScoreType3;
    ClientIntake_ClientIntakeSBIRT_ScoreValue3;
    SbirtOtherspec3;
    ClientIntake_ClientIntakeSBIRT_ClientSBIRTCont;
    SBIRTclasscode;
    GrantInactFlag;
    InactFlag;
    FFY;
    Quarter;
    Month;
    ConductedInterview;
    GenderCode;
    GenderOtherSpecify;
    HispanicLatino;
    EthnicCentralAmerican;
    EthnicCuban;
    EthnicDominican;
    EthnicMexican;
    EthnicPuertoRican;
    EthnicSouthAmerican;
    EthnicOther;
    EthnicOtherSpec;
    RaceBlack;
    RaceAsian;
    RaceAmericanIndian;
    RaceNativeHawaiian;
    RaceAlaskaNative;
    RaceWhite;
    BirthYear;
    BirthMonth;
    Age;
    AgeGroup;
    Veteran;
    MilitaryServed;
    ActiveDuty;
    NeverDeployed;
    IraqAfghanistan;
    PersianGulf;
    VietnamSoutheastAsia;
    Korea;
    WWII;
    DeployedCombatZone;
    FamilyActiveDuty;
    ServiceMemRelationship1;
    ServiceMemExpOther1;
    ServiceMemExpDeployed1;
    ServiceMemExpInjured1;
    ServiceMemExpCombatStress1;
    ServiceMemExpDeceased1;
    ServiceMemRelationship2;
    ServiceMemExpOther2;
    ServiceMemExpDeployed2;
    ServiceMemExpInjured2;
    ServiceMemExpCombatStress2;
    ServiceMemExpDeceased2;
    ServiceMemRelationship3;
    ServiceMemExpOther3;
    ServiceMemExpDeployed3;
    ServiceMemExpInjured3;
    ServiceMemExpCombatStress3;
    ServiceMemExpDeceased3;
    ServiceMemRelationship4;
    ServiceMemExpOther4;
    ServiceMemExpDeployed4;
    ServiceMemExpInjured4;
    ServiceMemExpCombatStress4;
    ServiceMemExpDeceased4;
    ServiceMemRelationship5;
    ServiceMemExpOther5;
    ServiceMemExpDeployed5;
    ServiceMemExpInjured5;
    ServiceMemExpCombatStress5;
    ServiceMemExpDeceased5;
    ServiceMemRelationship6;
    ServiceMemExpOther6;
    ServiceMemExpDeployed6;
    ServiceMemExpInjured6;
    ServiceMemExpCombatStress6;
    ServiceMemExpDeceased6;
    DAUseAlcoholDays;
    DAUseAlcoholIntox5Days;
    DAUseAlcoholIntox4Days;
    DAUseIllegDrugsDays;
    DAUseBothDays;
    CocaineCrackDays;
    CocaineCrackRoute;
    MarijuanaHashDays;
    MarijuanaHashRoute;
    OpiatesHeroinDays;
    OpiatesHeroinRoute;
    OpiatesMorphineDays;
    OpiatesMorphineRoute;
    OpiatesDiluadidDays;
    OpiatesDiluadidRoute;
    OpiatesDemerolDays;
    OpiatesDemerolRoute;
    OpiatesPercocetDays;
    OpiatesPercocetRoute;
    OpiatesDarvonDays;
    OpiatesDarvonRoute;
    OpiatesCodeineDays;
    OpiatesCodeineRoute;
    OpiatesTylenolDays;
    OpiatesTylenolRoute;
    OpiatesOxycoDays;
    OpiatesOxycoRoute;
    NonPresMethadoneDays;
    NonPresMethadoneRoute;
    HallucPsychDays;
    HallucPsychRoute;
    MethamDays;
    MethamRoute;
    BenzodiazepinesDays;
    BenzodiazepinesRoute;
    BarbituatesDays;
    BarbituatesRoute;
    NonPrescGhbDays;
    NonPrescGhbRoute;
    KetamineDays;
    KetamineRoute;
    OtherTranquilizersDays;
    OtherTranquilizersRoute;
    InhalantsDays;
    InhalantsRoute;
    OtherIllegalDrugsDays;
    OtherIllegalDrugsRoute;
    OtherIllegalDrugsSpec;
    InjectedDrugs;
    ParaphenaliaUsedOthers;
    LivingWhere;
    LivingHoused;
    LivingHousedSpec;
    LivingConditionsSatisfaction;
    ImpactStress;
    ImpactActivity;
    ImpactEmotional;
    Pregnant;
    Children;
    ChildrenNr;
    ChildrenCustody;
    ChildrenCustodyNr;
    ChildrenCustodyLost;
    TrainingProgram;
    TrainingProgramSpec;
    EducationYears;
    EmployStatus;
    EmployStatusSpec;
    Employment;
    IncomeWages;
    IncomePubAssist;
    IncomeRetirement;
    IncomeDisability;
    IncomeNonLegal;
    IncomeFamFriends;
    IncomeOther;
    IncomeOtherSpec;
    EnoughMoneyForNeeds;
    ArrestedDays;
    ArrestedDrugDays;
    ArrestedConfineDays;
    NrCrimes;
    AwaitTrial;
    ParoleProbation;
    HealthStatus;
    InpatientPhysical;
    InpatientPhysicalNights;
    InpatientMental;
    InpatientMentalNights;
    InpatientAlcoholSA;
    InpatientAlcoholSANights;
    OutpatientPhysical;
    OutpatientPhysicalTimes;
    OutpatientMental;
    OutpatientMentalTimes;
    OutpatientAlcoholSA;
    OutpatientAlcoholSATimes;
    ERPhysical;
    ERPhysicalTimes;
    ERMental;
    ERMentalTimes;
    ERAlcoholSA;
    ERAlcoholSATimes;
    SexActivity;
    SexContacts;
    SexUnprot;
    SexUnprotHIVAids;
    SexUnprotInjDrugUser;
    SexUnprotHigh;
    fHIVTest;
    fHIVTestResult;
    LifeQuality;
    HealthSatisfaction;
    EnoughEnergyForEverydayLife;
    PerformDailyActivitiesSatisfaction;
    SelfSatisfaction;
    Depression;
    Anxiety;
    Hallucinations;
    BrainFunction;
    ViolentBehavior;
    Suicide;
    PsycholEmotMedication;
    PsycholEmotImpact;
    AnyViolence;
    Nightmares;
    TriedHard;
    ConstantGuard;
    NumbAndDetach;
    PhysicallyHurt;
    AttendVoluntary;
    AttendVoluntaryTimes;
    AttendReligious;
    AttendReligiousTimes;
    AttendOtherOrg;
    AttendOtherOrgTimes;
    InteractFamilyFriends;
    WhomInTrouble;
    WhomInTroubleSpec;
    RelationshipSatisfaction;
    FLWPStatus;
    FLWPStatusSpec;
    ReceivingServices;
    DischargeDate;
    DischargeStatusCompl;
    DischargeStatusTermReason;
    OtherDischargeStatTermRsnSpec;
    jHIVTest;
    jHIVTestResult;
    SvcCaseManagement;
    SvcDayTreatment;
    SvcInpatient;
    SvcOutpatient;
    SvcOutreach;
    SvcIntensiveOutpatient;
    SvcMethadone;
    SvcResidentialRehab;
    SvcHospitalInpatient;
    SvcFreeStandingRes;
    SvcAmbulatoryDetox;
    SvcAfterCare;
    SvcRecoverySupport;
    SvcOtherModalities;
    SvcOtherModalitesSpec;
    SvcScreening;
    SvcBriefIntervention;
    SvcBriefTreatment;
    SvcReferralTreatment;
    SvcAssessment;
    SvcTreatmentPlanning;
    SvcIndividualCouns;
    SvcGroupCouns;
    SvcFamilyMarriageCouns;
    SvcCoOccurring;
    SvcPharmacological;
    SvcHIVAIDSCouns;
    SvcOtherClinicalCouns;
    SvcOtherClinicalCounsSpec;
    SvcFamilyServices;
    SvcChildCare;
    SvcPreEmployment;
    SvcEmploymentCoaching;
    SvcIndividualCoord;
    SvcTransportation;
    SvcHIVAIDSServices;
    SvcDrugFreeHousing;
    SvcOtherCaseMgmt;
    SvcOtherCaseMgmtSpec;
    SvcMedicalCare;
    SvcAlcoholDrugTesting;
    SvcHIVAIDSMedical;
    SvcOtherMedical;
    SvcOtherMedicalSpec;
    SvcContinuingCare;
    SvcRelapsePrevention;
    SvcRecoveryCoaching;
    SvcSelfHelpSupport;
    SvcSpiritualSupport;
    SvcOtherAfterCare;
    SvcOtherAfterCareSpec;
    SvcSubstanceAbuseEdu;
    SvcHIVAIDSEdu;
    SvcOtherEdu;
    SvcOtherEduSpec;
    SvcPeerCoaching;
    SvcHousingSupport;
    SvcDrugFreeSocial;
    SvcInformationReferral;
    SvcOtherRecovery;
    SvcOtherRecoverySpec;
    IntakeDate;
    InterviewCreateDate;
}

let OPTIONS = {
    YES : "1",
    NO: "0"
};

class Error {
    itemID;
    message;
    constructor(id, msg) {
        this.itemID = id;
        this.message = msg;
    }
}

var validationErrors = [];
function addError(id, msg) {
    validationErrors.push(new Error(id, msg));
}

//check if nontrimmed whitespace is handled correctly by frontend and backend
function validateSection1(gpra) {
    let g = gpra;

    //check date is valid and matches format
    if(!moment(g.InterviewDate).isValid() || !moment(g.InterviewDate,'MM-DD-YYYY').isValid())
        addError('InterviewDate', 'Invalid date');
    else {
        //Intakes, discharges, and followups must follow certain rules based on intake date
    }

    //at least one diagnosis must be listed

    //medication days must be a number between 0 and 30
    //only check if opioid/alcohol disorder is "Yes"
    if(g.OpioidDisorder === OPTIONS.YES) {
        let opioidDays = {MethadoneMedicationDays: g.MethadoneMedicationDays,
            BuprenorphineMedicationDays: g.BuprenorphineMedicationDays,
            NaltrexoneMedicationDays: g.NaltrexoneMedicationDays,
            NaltrexoneXRMedicationDays: g.NaltrexoneXRMedicationDays};
        for(let key in opioidDays) {
            let val = opioidDays[key];
            if(!isEmpty(val) && !isIntegerInRange(val, 0, 30))
                addError(key, 'Must be an integer between 0 and 30');
        }
    }

    if(g.AlcoholDisorder === OPTIONS.YES) {
        let alcoholDays = {NaltrexoneAlcMedicationDays: g.NaltrexoneAlcMedicationDays,
            NaltrexoneXRAlcMedicationDays: g.NaltrexoneXRAlcMedicationDays,
            DisulfiramMedicationDays: g.DisulfiramMedicationDays,
            AcamprosateMedicationDays: g.AcamprosateMedicationDays};
        for(let key in alcoholDays) {
            let val = alcoholDays[key];
            if(!isEmpty(val) && !isIntegerInRange(val, 0, 30))
                addError(key, 'Must be an integer between 0 and 30');
        }
    }
    return validationErrors;
}

function isIntegerInRange(value, min, max) {
    if(isNaN(value))
        return false;
    let num = Number(value);
    return Number.isInteger(num) && num >= min && num <= max;
}

function isEmpty(value) {
    return value.trim() === "";
}